## 文档信息

- **文档名称**：JobVerse 演示增强功能说明  
- **用途**：用于课程项目最终演示前的功能扩展说明，便于在不大改架构的前提下增加可展示点  
- **适用范围**：本说明主要关注“功能可演示性”，暂不展开生产级安全、性能与高并发设计（可在 SDD 的安全/性能章节后续补充）  
- **与 SRS 的对应**：建议在 `需求分析/SRS.md` 的第 4 章新增对应系统特性条目（例如 4.8～4.12），并为每项功能分配 `FR-*` 需求编号  

---

## 1. 背景与目标

JobVerse 当前已具备“搜索 → 详情 → 收藏/投递 → 企业候选人管理 → 学校审核 → 风控/审计”的基础闭环。  
为了让最终演示更“可讲故事”、更像真实招聘平台，本次扩展聚焦于：

- **闭环强化**：把跨角色事件（投递、审核、面试）用“通知/时间线”串起来  
- **互动增强**：投递材料、面试邀请等让观众看到更多交互  
- **信息呈现更丰富**：记录、筛选、导出、时间线等带来可视化展示点  

---

## 2. 功能清单与优先级

- **P1（强烈建议实现）**
  - **通知中心/消息中心**
  - **面试邀请与面试安排**
  - **投递时间线（状态变更历史）+ 企业反馈**
  - **简历中心（多份简历/默认简历）+ 投递时选择简历/求职信**

- **P2（加分项，可选）**
  - **保存搜索 & 岗位订阅（命中时生成通知）**
  - **基于标签的简易推荐**

---

## 3. 功能详细说明

### 3.1 通知中心 / 消息中心（P1）

#### 3.1.1 目标与价值

- 把“学生/企业/学校”的关键动作实时（或准实时）反馈给对方  
- 演示时能清晰展示：**一次投递如何驱动多端变化**（企业收到提醒、学生看到状态更新、企业收到审核结果等）

#### 3.1.2 范围与非范围

- **范围**
  - 站内通知：通知列表、未读数、已读/全部已读
  - 通知跳转：点击通知跳转到岗位详情/企业候选人/审核详情/投递详情等
- **非范围（演示期不做）**
  - WebSocket 实时推送（可先做“刷新查看/轮询”）
  - 邮件/短信推送

#### 3.1.3 触发事件（建议最小集）

- 学生投递成功 → 学生收到“投递成功”，企业收到“新投递”
- 企业查看简历/更新状态 → 学生收到“状态更新”
- 企业发起/修改/取消面试 → 学生收到“面试邀请/变更”
- 学校审核通过/驳回/退回修改 → 企业收到“审核结果”

#### 3.1.4 页面/入口建议

- 学生端：`/student/notifications`（或工作台右上角铃铛入口）
- 企业端：`/employer/notifications`
- 管理端（可选）：`/admin/notifications`

#### 3.1.5 数据建议（SDD/DB）

新增 `Notification` 表（或模型），建议字段：

- `id`
- `userId`（接收者）
- `type`（APPLY_SUCCESS / NEW_APPLICATION / STATUS_UPDATE / INTERVIEW / REVIEW_RESULT / SYSTEM 等）
- `title`、`content`（摘要）
- `resourceType`、`resourceId`（关联对象：JOB/APPLICATION/INTERVIEW/REVIEW…）
- `isRead`、`readAt`
- `createdAt`

#### 3.1.6 API 草案（示例）

- `GET /api/v1/notifications?isRead=&type=&page=&limit=`：通知列表  
- `GET /api/v1/notifications/unread-count`：未读数量  
- `PUT /api/v1/notifications/:id/read`：标记已读  
- `PUT /api/v1/notifications/read-all`：全部已读（P2）

#### 3.1.7 演示脚本（建议）

- 学生投递某岗位 → 打开铃铛看到“投递成功”  
- 企业端刷新铃铛 → 看到“收到新投递” → 点击跳转候选人列表  
- 企业把候选人状态改为“面试中” → 学生端铃铛出现“状态更新”

---

### 3.2 面试邀请与面试安排（P1）

#### 3.2.1 目标与价值

- 让招聘流程从“投递—状态更新”升级为“投递—面试—录用/拒绝”，更完整、更易展示

#### 3.2.2 核心流程

- 企业在候选人详情/弹窗中发起面试邀请  
- 系统创建面试记录，并向学生生成通知  
- 学生确认/拒绝（可选：提交改期建议）  
- 企业查看学生确认状态，可修改/取消邀请

#### 3.2.3 页面/入口建议

- 企业端候选人页（现有）增加“发起面试”按钮与面试详情弹窗  
- 学生端投递详情页显示面试卡片（时间/方式/地点/链接/状态）

#### 3.2.4 数据建议（SDD/DB）

新增 `Interview`（或 `InterviewInvitation`）表，建议字段：

- `id`
- `applicationId`（关联投递）
- `employerId`（发起人，可选）
- `scheduledAt`
- `mode`（ONLINE/OFFLINE）
- `locationOrLink`
- `note`
- `status`（PENDING/CONFIRMED/DECLINED/CANCELLED/RESCHEDULE_REQUESTED）
- `studentComment`（学生备注/改期说明，可选）
- `createdAt`、`updatedAt`

#### 3.2.5 API 草案（示例）

- 企业端：
  - `POST /api/v1/employer/applications/:id/interviews`（创建面试邀请）
  - `PUT /api/v1/employer/interviews/:id`（修改/取消）
- 学生端：
  - `GET /api/v1/applications/:id/interview`（查看面试）
  - `PUT /api/v1/interviews/:id/respond`（确认/拒绝/改期）

#### 3.2.6 演示脚本（建议）

- 企业对某候选人发起“线上面试”，填写会议链接  
- 学生端打开投递详情 → 看到面试卡片 → 点击确认  
- 企业端看到确认状态变化（并生成通知）

---

### 3.3 投递时间线（状态变更历史）+ 企业反馈（P1）

#### 3.3.1 目标与价值

- 让“我的投递”从列表升级为“可解释的时间线”，演示更直观  
- 企业在最终录用/拒绝时给出对学生可见的简短反馈，便于演示“沟通”

#### 3.3.2 核心流程

- 投递创建时写入时间线事件：APPLIED  
- 企业查看简历时写入事件：VIEWED  
- 企业更新状态写入事件：INTERVIEWING/ACCEPTED/REJECTED  
- 面试邀请创建/变更写入事件：INTERVIEW_CREATED/UPDATED/CANCELLED  
- 学生查看投递详情页：展示时间线与企业反馈

#### 3.3.3 页面/入口建议

- 学生端：在“我的投递”列表中为每条记录增加“查看详情”  
  - 新页：`/student/applications/[id]`（时间线 + 面试 + 反馈）
- 企业端：候选人详情弹窗中增加“反馈”输入（仅在 ACCEPTED/REJECTED 时必填或可选）

#### 3.3.4 数据建议（SDD/DB）

新增 `ApplicationEvent` 表，建议字段：

- `id`
- `applicationId`
- `type`（APPLIED / VIEWED / STATUS_CHANGED / INTERVIEW_CREATED / INTERVIEW_RESPONDED / REVIEW_RESULT…）
- `actorRole`（STUDENT/EMPLOYER/SCHOOL_ADMIN/PLATFORM_ADMIN/SYSTEM）
- `actorId`（可选）
- `metadata`（JSON：例如 fromStatus/toStatus、interviewId、comment 等）
- `createdAt`

企业反馈（最省事方式）：

- 在 `Application` 上新增 `feedback`（对学生可见）与 `employerNote`（仅企业可见，可选）字段  

#### 3.3.5 API 草案（示例）

- `GET /api/v1/applications/:id`（投递详情，包含反馈/面试摘要）  
- `GET /api/v1/applications/:id/events`（时间线事件列表）  
- `PUT /api/v1/employer/applications/:id/feedback`（企业填写反馈，或复用更新状态接口）

---

### 3.4 简历中心（多份简历/默认简历）+ 投递时选择简历（P1）

#### 3.4.1 目标与价值

- 演示时能展示“学生的真实投递材料管理”，避免投递仅是一个按钮  
- 支持一键复用：默认简历 + 求职信模板（可选）

#### 3.4.2 核心流程

- 学生在简历中心维护多份简历（文本或链接）
- 设置默认简历
- 投递岗位时弹窗选择简历（默认选中默认简历），填写求职信
- 企业在候选人详情查看该投递使用的简历/求职信

#### 3.4.3 页面/入口建议

- 学生端新增：`/student/resumes`（简历中心）  
- 岗位详情投递按钮：改为弹窗表单（选择简历 + 求职信）  

#### 3.4.4 数据建议（SDD/DB）

新增 `Resume` 表（推荐）：

- `id`
- `userId`
- `name`
- `content`（文本或链接）
- `isDefault`
- `createdAt`、`updatedAt`

投递材料保存（两种方案）：

- **方案 A（最简单）**：投递时把简历内容/链接直接写入 `Application.resume`（快照）  
- **方案 B（结构化）**：`Application` 只保存 `resumeId` + `resumeSnapshot`（可选）  

#### 3.4.5 API 草案（示例）

- `GET /api/v1/resumes`（学生自己的简历列表）  
- `POST /api/v1/resumes`（新增）  
- `PUT /api/v1/resumes/:id`（编辑）  
- `DELETE /api/v1/resumes/:id`（删除）  
- `PUT /api/v1/resumes/:id/default`（设为默认）  
- `POST /api/v1/jobs/:id/apply`（扩展请求体：`resumeId`/`resumeContent` + `coverLetter`）

---

### 3.5 保存搜索 / 岗位订阅 & 简易推荐（P2，可选）

#### 3.5.1 保存搜索与订阅

- 学生保存搜索条件（关键词、城市、薪资范围、标签等）
- 新岗位审核通过时（或定时任务）匹配订阅条件，命中则生成通知

**数据建议**：`SavedSearch` 表（userId + query json + enabled + createdAt）  

**API 草案**：

- `POST /api/v1/saved-searches`
- `GET /api/v1/saved-searches`
- `DELETE /api/v1/saved-searches/:id`

#### 3.5.2 简易推荐

- 基于学生收藏/投递岗位的 `tags`，推荐相同标签的岗位
- 演示期不做复杂算法，仅做可解释规则

**API 草案**：

- `GET /api/v1/recommend/jobs`（返回推荐岗位列表）

---

## 4. 与现有系统的集成点（对齐现有代码）

- **投递与候选人状态**：以 `Application` 的状态变化作为“通知 + 时间线”的主要事件源  
- **审核结果**：以 `Review` 的创建与 `Job.status` 更新作为“企业通知”的事件源  
- **审计服务**：可复用现有审计机制记录“面试邀请/反馈填写/通知读取”等操作（演示增强）  
- **前端入口**：可复用现有三端布局组件（`StudentLayout` / `EmployerLayout` / `AdminLayout`）新增菜单项

---

## 5. 简要 SDD 修改说明（不在本次直接改 SDD 文件）

你们的 SDD（`软件设计/软件设计文档.md`）可以按以下最小修改补齐“设计闭环”。建议仅补关键点，避免大改全文：

### 5.1 数据设计（建议更新的内容）

- **新增数据表/模型**（建议以 Prisma 模型为准同步到 SDD）
  - `Notification`
  - `Interview`
  - `ApplicationEvent`
  - `Resume`
  - （可选）`SavedSearch`
- **更新表关系说明/ER 图**
  - `User ↔ Notification`：1 对多
  - `Application ↔ Interview`：1 对 0..1（或 1 对多，允许多轮面试）
  - `Application ↔ ApplicationEvent`：1 对多
  - `User ↔ Resume`：1 对多（默认简历约束）

### 5.2 接口设计（建议新增/补充的 API 清单）

- 通知：列表/未读数/已读/全部已读
- 面试：企业创建/修改/取消；学生确认/拒绝
- 时间线：投递详情 + 事件列表
- 简历：CRUD + 设置默认；投递接口扩展请求体

### 5.3 详细设计（模块/服务划分建议）

为降低改动，可选择“合并到现有服务”：

- `Resume`：建议归属 **user-service**（用户私有资源）  
- `Interview`、`ApplicationEvent`：建议归属 **job-service**（投递域）  
- `Notification`：两种思路
  - **方案 A（简单）**：归属 user-service（由其它服务调用写入）
  - **方案 B（更清晰）**：单独 notification-service（演示期可不拆）

### 5.4 设计图建议（SDD 可选补充）

- **时序图**（建议补 1～2 张即可）
  - 投递成功 → 写 Application → 写 ApplicationEvent → 生成两条 Notification  
  - 企业发起面试 → 写 Interview → 写 ApplicationEvent → 生成 Notification → 学生确认  
- **类图/组件图**：新增模型与现有 `Application/Job/User` 的关系

---

## 6. 建议的最小可演示实现组合（1 周内优先）

- 通知中心（列表 + 未读数 + 标记已读）  
- 面试邀请（企业发起 + 学生确认/拒绝）  
- 投递时间线（至少记录：投递/已查看/状态变更/面试事件）  
- 简历中心（多份简历 + 默认简历 + 投递时选择简历）

---

## 7. 非目标与约束（演示期）

- 不做外部推送（短信/邮件），仅站内通知  
- 不做 WebSocket 实时推送，可用刷新/轮询替代  
- 不展开生产级权限/审计完整性/加密存储等（可在后续迭代补充）


